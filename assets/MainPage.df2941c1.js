import{X as f,L as M,E as P,d as A,u as E,r as h,c as p,a as L,b as t,w as g,v as b,e as C,t as S,o as w}from"./index.f5f30231.js";class R{constructor(){this._isAcquired=!1,this._acquiredMap=new Map,this.waitingMap=new Map,this.waitingList=[]}acquire(e){if(e){if(!this._acquiredMap.has(e)||!this._acquiredMap.get(e))return this._acquiredMap.set(e,!0),Promise.resolve()}else if(!this._isAcquired)return this._isAcquired=!0,Promise.resolve();return new Promise(s=>{if(e)if(this.waitingMap.has(e)){const i=this.waitingMap.get(e);i&&(i.push(s),this.waitingMap.set(e,i))}else this.waitingMap.set(e,[s]);else this.waitingList.push(s)})}isAcquired(e){return e?this._acquiredMap.has(e)?this._acquiredMap.get(e):!1:this._isAcquired}release(e){if(e){if(!this._acquiredMap.has(e)||!this._acquiredMap.get(e))throw new Error("Please acquire a lock for "+e+" before releasing!!");{const s=this.waitingMap.get(e);if(s&&s.length>0){const i=this.waitingMap.get(e)?.shift();i&&i()}else this.waitingMap.has(e)&&this.waitingMap.delete(e),this._acquiredMap.set(e,!1)}}else if(this._isAcquired)if(this.waitingList.length>0){const s=this.waitingList.shift();s&&s()}else this._isAcquired=!1;else throw new Error("Please acquire a lock before releasing!!")}}class o{constructor(){this.list=new Map,this.lock=new R}static shared(){return o.instance||(o.instance=new o),o.instance}async add(e,s){return await this.lock.acquire(),this.list.set(e,s),this.lock.release()}async execute(e,s){if(await this.lock.acquire(),this.list.has(e)){const i=this.list.get(e);return this.list.delete(e),this.lock.release(),i?.(s)}return this.lock.release()}async count(){await this.lock.acquire();const e=this.list.size;return this.lock.release(),e}}class a{constructor(){this.lock=new R,this.uid=0}static shared(){return a.instance||(a.instance=new a),a.instance}static async generate(){await a.shared().lock.acquire();const e=(++a.shared().uid).toString();return a.shared().lock.release(),e}}class z{static call(e){return new Promise(s=>{if(!f.shared().initialized)return M.e("[XRemoteClient : call] The WASM module is not initialized"),s(void 0);try{a.generate().then(i=>{o.shared().add(i,n=>s(f.shared().config.serializer.decodeFunctionReturnValue(n))),f.shared().module.ProxyClient.callFromJavascript(e.data(),n=>{o.shared().execute(i,n)})})}catch(i){return M.e("[XRemoteClient : call] Error: "+P.get(i)),s(void 0)}})}}class _{constructor(e,s){this.name=e,this.value=s}}class V{constructor(e,...s){this.functionName=e,this.params=s}data(){return f.shared().config.serializer.encodeRequest(this.functionName,...this.params)}}const X={class:"container"},B={key:0},N={class:"text-left"},T=t("h4",{id:"pageTitle",class:"my-5 text-center"},"Login",-1),F={class:"mb-3"},O=t("label",{for:"fieldUsername",class:"form-label"},"Username",-1),U={class:"mb-3"},W=t("label",{for:"fieldPassword",class:"form-label"},"Password",-1),k={class:"mb-3 form-check"},J=t("label",{class:"form-check-label",for:"fieldRemember"},"Remember",-1),j={class:"my-5 text-center"},G={id:"responseMessage",class:"text-"},H=t("button",{type:"submit",class:"btn btn-primary"},"Submit",-1),K={key:1},Q=t("div",{class:"text-center"},[t("p",{class:"my-5"},"Loading...")],-1),Y=[Q],$=A({__name:"MainPage",setup(u){const e=E(),s=h(null),i=h(null),n=h(!1),v="Use account paulo/123456 to success login",d=h(v);async function q(c){c.preventDefault(),m("Calling...");const r=new V("sample.login",new _("username",s.value),new _("password",i.value),new _("remember",n.value));let l=await z.call(r);m(l?"Response: "+l:"Response: ERROR!")}function m(c){c?d.value=c:d.value="ERROR!"}function x(){s.value=null,i.value=null,n.value=!1,d.value=v}return(c,r)=>(w(),p("div",X,[L(e).isLoaded?(w(),p("div",B,[t("div",N,[T,t("form",{onSubmit:q},[t("div",F,[O,g(t("input",{id:"fieldUsername","onUpdate:modelValue":r[0]||(r[0]=l=>s.value=l),type:"text",class:"form-control"},null,512),[[b,s.value]])]),t("div",U,[W,g(t("input",{id:"fieldPassword","onUpdate:modelValue":r[1]||(r[1]=l=>i.value=l),type:"password",class:"form-control"},null,512),[[b,i.value]])]),t("div",k,[g(t("input",{id:"fieldRemember","onUpdate:modelValue":r[2]||(r[2]=l=>n.value=l),type:"checkbox",class:"form-check-input"},null,512),[[C,n.value]]),J]),t("p",j,[t("strong",null,[t("small",G,S(d.value),1)])]),t("div",{class:"form-bt-group"},[H,t("button",{type:"button",class:"btn btn-primary",onClick:x},"Clear")])],32)])])):(w(),p("div",K,Y))]))}});export{$ as default};
